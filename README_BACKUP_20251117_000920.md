# üïµÔ∏è SanpaHolmes - Sistema de Carrito de Compras

> Sistema completo de e-commerce desarrollado para el evento Scout SanpaHolmes 2025
> **Arquitectura: MVC (Modelo-Vista-Controlador)**

---

## üìã Descripci√≥n del Proyecto

**SanpaHolmes** es un sistema de carrito de compras web desarrollado espec√≠ficamente para gestionar las ventas durante el evento Scout SanpaHolmes realizado el 15 de noviembre de 2025.

El sistema permite a los asistentes del evento realizar pedidos de comida y bebidas a trav√©s de una interfaz web intuitiva, mientras que los organizadores pueden administrar productos, visualizar ventas en tiempo real y gestionar pedidos desde un panel de administraci√≥n.

### Caracter√≠sticas principales

- üõí **Carrito de compras completo** con gesti√≥n de productos en tiempo real
- üë§ **Sistema de autenticaci√≥n** con JWT para administradores
- üìä **Panel de administraci√≥n** para gesti√≥n de productos y visualizaci√≥n de ventas
- üí≥ **Proceso de checkout** con validaci√≥n de datos del comprador
- üì± **Dise√±o responsive** adaptado para m√≥viles y tablets
- üîÑ **Persistencia de sesi√≥n** - La sesi√≥n permanece activa incluso al recargar la p√°gina
- üí¨ **Integraci√≥n con WhatsApp** para notificar a los compradores
- üìà **Exportaci√≥n a Google Sheets** para an√°lisis de datos
- üóÑÔ∏è **Base de datos SQLite** con CRUD completo
- üèóÔ∏è **Arquitectura MVC** - Separaci√≥n clara de responsabilidades

---

## üèóÔ∏è Arquitectura MVC (Modelo-Vista-Controlador)

Este proyecto sigue el patr√≥n de dise√±o **MVC (Model-View-Controller)**, que separa la l√≥gica de negocio, la presentaci√≥n y el control de datos en capas independientes.

### üìä ¬øQu√© es MVC?

**MVC** es un patr√≥n de arquitectura de software que divide una aplicaci√≥n en tres componentes principales:

1. **Modelo (Model)**: Gestiona los datos y la l√≥gica de negocio
2. **Vista (View)**: Maneja la presentaci√≥n y la interfaz de usuario
3. **Controlador (Controller)**: Procesa las solicitudes y coordina Modelo-Vista

### üéØ Beneficios de MVC en este proyecto

- ‚úÖ **Separaci√≥n de responsabilidades**: Cada capa tiene una funci√≥n espec√≠fica
- ‚úÖ **Mantenibilidad**: Cambios en una capa no afectan a las dem√°s
- ‚úÖ **Escalabilidad**: F√°cil agregar nuevas funcionalidades
- ‚úÖ **Testeo**: Cada capa puede probarse independientemente
- ‚úÖ **Reutilizaci√≥n**: Los modelos y controladores pueden usarse en m√∫ltiples vistas
- ‚úÖ **Trabajo en equipo**: Diferentes desarrolladores pueden trabajar en capas distintas

---

## ‚ö†Ô∏è Nota Importante: Migraci√≥n a MVC Completada

Este proyecto ha sido **completamente migrado a arquitectura MVC**. Las siguientes carpetas y archivos fueron eliminados:

- ‚ùå **Carpeta `api/`**: Reemplazada por `routes/` + `controllers/` + `models/`
- ‚ùå **Archivo `db/sqlite-db.js`**: Funcionalidad migrada a `models/`

**Si encuentras referencias antiguas en documentaci√≥n o comentarios, ign√≥ralas.** La estructura actual es 100% MVC.

---

## üöÄ Tecnolog√≠as Utilizadas

### Backend

- **Node.js 18+** - Entorno de ejecuci√≥n de JavaScript
- **Express 4.18** - Framework web para APIs REST
- **SQLite (better-sqlite3)** - Base de datos relacional local
- **JWT (jsonwebtoken)** - Autenticaci√≥n basada en tokens
- **Bcrypt** - Encriptaci√≥n segura de contrase√±as
- **CORS** - Control de acceso entre dominios

### Frontend

- **React 18** - Librer√≠a para interfaces de usuario
- **TypeScript** - Superset tipado de JavaScript
- **Vite 5** - Build tool moderno y r√°pido
- **Tailwind CSS 3** - Framework de estilos utility-first
- **Radix UI** - Componentes accesibles headless
- **Lucide React** - Iconos modernos
- **Sonner** - Sistema de notificaciones toast
- **React Router DOM 6** - Enrutamiento del lado del cliente

### Herramientas de Desarrollo

- **ESLint** - Linter para JavaScript/TypeScript
- **PostCSS** - Procesador de CSS
- **dotenv** - Gesti√≥n de variables de entorno

---

## üìÅ Estructura del Proyecto (Arquitectura MVC)

```
demo_sanpaholmes/
‚îÇ
‚îú‚îÄ‚îÄ üìÇ BACKEND (Arquitectura MVC)
‚îÇ
‚îú‚îÄ‚îÄ models/                       # üìä MODELO - Capa de datos
‚îÇ   ‚îú‚îÄ‚îÄ database.js              # Conexi√≥n centralizada a SQLite
‚îÇ   ‚îú‚îÄ‚îÄ ProductoModel.js         # Operaciones de productos
‚îÇ   ‚îú‚îÄ‚îÄ CompraModel.js           # Operaciones de compras
‚îÇ   ‚îî‚îÄ‚îÄ UsuarioModel.js          # Operaciones de usuarios
‚îÇ
‚îú‚îÄ‚îÄ controllers/                  # üéÆ CONTROLADOR - L√≥gica de negocio
‚îÇ   ‚îú‚îÄ‚îÄ ProductoController.js    # L√≥gica de productos
‚îÇ   ‚îú‚îÄ‚îÄ CompraController.js      # L√≥gica de compras
‚îÇ   ‚îî‚îÄ‚îÄ AuthController.js        # L√≥gica de autenticaci√≥n
‚îÇ
‚îú‚îÄ‚îÄ routes/                       # üõ£Ô∏è RUTAS - Definici√≥n de endpoints
‚îÇ   ‚îú‚îÄ‚îÄ index.js                 # Router principal
‚îÇ   ‚îú‚îÄ‚îÄ productos.js             # Rutas de productos
‚îÇ   ‚îú‚îÄ‚îÄ compras.js               # Rutas de compras
‚îÇ   ‚îî‚îÄ‚îÄ auth.js                  # Rutas de autenticaci√≥n
‚îÇ
‚îú‚îÄ‚îÄ middleware/                   # üîí Middleware - Seguridad
‚îÇ   ‚îî‚îÄ‚îÄ auth.js                  # Validaci√≥n JWT
‚îÇ
‚îú‚îÄ‚îÄ server.js                     # üöÄ Servidor Express
‚îÇ
‚îú‚îÄ‚îÄ üìÇ FRONTEND (Arquitectura Adaptada MVC)
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ views/                   # üé® VISTA - Componentes UI
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ LandingPage.tsx     # P√°gina de inicio
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Menu.tsx            # Cat√°logo de productos
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Cart.tsx            # Carrito de compras
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Checkout.tsx        # Proceso de pago
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ VendorLogin.tsx     # Login de administradores
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AdminPanelNew.tsx   # Panel de administraci√≥n
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ Navbar.tsx          # Barra de navegaci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/                 # Componentes reutilizables
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ controllers/            # üéÆ CONTROLADOR - Gesti√≥n de estado
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AuthContext.tsx     # Control de autenticaci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ CartContext.tsx     # Control del carrito
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ services/               # üîå SERVICIOS - Llamadas API
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ (preparado para servicios API)
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ types/                  # üìù Tipos TypeScript
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ index.ts           # Definiciones de tipos
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ config/                 # ‚öôÔ∏è Configuraci√≥n
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ api.ts             # URLs y configuraci√≥n de API
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx                # Componente ra√≠z con rutas
‚îÇ   ‚îî‚îÄ‚îÄ main.tsx               # Punto de entrada de React
‚îÇ
‚îú‚îÄ‚îÄ db/                          # üóÑÔ∏è Base de datos
‚îÇ   ‚îú‚îÄ‚îÄ sanpaholmes.db          # Base de datos SQLite
‚îÇ   ‚îî‚îÄ‚îÄ init.js                 # Script de inicializaci√≥n
‚îÇ
‚îú‚îÄ‚îÄ public/                      # üì¶ Archivos est√°ticos
‚îÇ   ‚îú‚îÄ‚îÄ images/                # Im√°genes de productos
‚îÇ   ‚îî‚îÄ‚îÄ uploads/               # Carpeta de uploads
‚îÇ
‚îú‚îÄ‚îÄ server.js                  # Servidor Express principal
‚îú‚îÄ‚îÄ package.json               # Dependencias y scripts
‚îú‚îÄ‚îÄ tsconfig.json             # Configuraci√≥n de TypeScript
‚îú‚îÄ‚îÄ tailwind.config.js        # Configuraci√≥n de Tailwind
‚îú‚îÄ‚îÄ vite.config.ts            # Configuraci√≥n de Vite
‚îî‚îÄ‚îÄ vercel.json               # Configuraci√≥n de deployment
```

---

## üîÑ Flujo de Datos en la Arquitectura MVC

### Backend (Node.js + Express)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FLUJO DE UNA PETICI√ìN                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

1Ô∏è‚É£ Cliente ‚Üí 2Ô∏è‚É£ Rutas ‚Üí 3Ô∏è‚É£ Controlador ‚Üí 4Ô∏è‚É£ Modelo ‚Üí 5Ô∏è‚É£ Base de Datos
                                                           ‚îÇ
                                                           ‚ñº
Cliente ‚óÑ‚îÄ‚îÄ Rutas ‚óÑ‚îÄ‚îÄ Controlador ‚óÑ‚îÄ‚îÄ Modelo ‚óÑ‚îÄ‚îÄ Respuesta DB
```

#### Ejemplo pr√°ctico: Obtener todos los productos

**1. El cliente hace una petici√≥n:**
```javascript
GET http://localhost:3000/api/productos
```

**2. La ruta captura la petici√≥n** (`routes/productos.js`):
```javascript
router.get('/', ProductoController.listarProductos);
```

**3. El controlador procesa la l√≥gica** (`controllers/ProductoController.js`):
```javascript
async listarProductos(req, res) {
  try {
    const productos = await ProductoModel.obtenerProductos();
    res.json({ success: true, data: productos });
  } catch (error) {
    res.status(500).json({ success: false, error: error.message });
  }
}
```

**4. El modelo consulta la base de datos** (`models/ProductoModel.js`):
```javascript
obtenerProductos() {
  const db = getDB();
  return db.prepare('SELECT * FROM productos WHERE activo = 1').all();
}
```

**5. La respuesta viaja de vuelta al cliente** con los datos.

---

### Descripci√≥n de cada capa del Backend

#### üìä MODELO (models/)

**Responsabilidad:** Acceso directo a la base de datos y operaciones CRUD.

- **`database.js`**: Conexi√≥n centralizada a SQLite con `better-sqlite3`
- **`ProductoModel.js`**: 
  - `obtenerProductos()` - Lista productos activos
  - `obtenerTodosLosProductos()` - Lista todos (incluyendo inactivos)
  - `obtenerProductoPorId(id)` - Obtiene un producto espec√≠fico
  - `crearProducto(data)` - Inserta nuevo producto
  - `actualizarProducto(id, data)` - Actualiza producto existente
  - `eliminarProducto(id)` - Marca como inactivo
  - `eliminarProductoPermanente(id)` - Elimina f√≠sicamente
  - `obtenerProductoPorNombre(nombre)` - Busca por nombre
  
- **`CompraModel.js`**:
  - `obtenerCompras()` - Lista todas las compras
  - `crearCompra(data)` - Registra nueva compra
  - `actualizarEstadoListo(id, listo)` - Marca pedido como listo
  
- **`UsuarioModel.js`**:
  - `obtenerUsuarioPorUsername(username)` - Busca usuario
  - `verificarCredenciales(username, password)` - Valida login

**Principio clave:** Los modelos NO manejan l√≥gica de negocio, solo operaciones de datos.

---

#### üéÆ CONTROLADOR (controllers/)

**Responsabilidad:** L√≥gica de negocio, validaciones y coordinaci√≥n entre rutas y modelos.

- **`ProductoController.js`**:
  - Valida datos de entrada
  - Maneja errores
  - Formatea respuestas
  - Llama a los modelos correspondientes
  
- **`CompraController.js`**:
  - Valida datos de compra
  - Calcula totales
  - Procesa items del carrito
  - Registra transacciones
  
- **`AuthController.js`**:
  - Verifica credenciales
  - Genera tokens JWT
  - Maneja sesiones

**Principio clave:** Los controladores NO acceden directamente a la base de datos.

---

#### üõ£Ô∏è RUTAS (routes/)

**Responsabilidad:** Definir endpoints HTTP y mapearlos a controladores.

- **`index.js`**: Router principal que monta todos los sub-routers
  ```javascript
  router.use('/productos', productosRouter);
  router.use('/compras', comprasRouter);
  router.use('/auth', authRouter);
  ```

- **`productos.js`**: Define rutas de productos
  ```javascript
  GET    /api/productos          ‚Üí listarProductos
  GET    /api/productos/:id      ‚Üí obtenerProducto
  POST   /api/productos          ‚Üí crearProducto
  PUT    /api/productos/:id      ‚Üí actualizarProducto
  DELETE /api/productos/:id      ‚Üí eliminarProducto
  ```

- **`compras.js`**: Define rutas de compras
  ```javascript
  POST   /api/compras                     ‚Üí crearCompra (p√∫blico)
  GET    /api/compras                     ‚Üí listarCompras (autenticado)
  GET    /api/compras/estadisticas/ventas ‚Üí obtenerEstadisticas (autenticado)
  GET    /api/compras/:id                 ‚Üí obtenerCompraPorId (autenticado)
  PATCH  /api/compras/:id/estado          ‚Üí actualizarEstadoCompra (autenticado)
  DELETE /api/compras/:id                 ‚Üí eliminarCompra (autenticado)
  ```

- **`auth.js`**: Define rutas de autenticaci√≥n
  ```javascript
  POST   /api/auth/login          ‚Üí login
  ```

**Principio clave:** Las rutas SOLO definen endpoints, no contienen l√≥gica.

---

### Frontend (React + TypeScript)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ               ARQUITECTURA FRONTEND ADAPTADA MVC             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

Usuario ‚Üí Vista ‚Üí Controlador ‚Üí API (Backend MVC)
            ‚îÇ         ‚îÇ              ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                   Estado
```

#### üé® VISTAS (src/views/)

**Responsabilidad:** Componentes React que renderizan la interfaz de usuario.

- **`LandingPage.tsx`**: P√°gina de bienvenida
- **`Menu.tsx`**: Cat√°logo de productos (consume ProductoController/CartContext)
- **`Cart.tsx`**: Visualizaci√≥n del carrito
- **`Checkout.tsx`**: Formulario de compra
- **`AdminPanelNew.tsx`**: Panel de administraci√≥n
- **`VendorLogin.tsx`**: Formulario de login
- **`Navbar.tsx`**: Barra de navegaci√≥n

**Principio clave:** Las vistas NO contienen l√≥gica de negocio, solo presentaci√≥n.

---

#### üéÆ CONTROLADORES (src/controllers/)

**Responsabilidad:** Gesti√≥n de estado global y l√≥gica de interacci√≥n.

- **`CartContext.tsx`**: 
  - Gestiona estado del carrito
  - Funciones: `addToCart()`, `removeFromCart()`, `updateQuantity()`, `clearCart()`
  
- **`AuthContext.tsx`**:
  - Gestiona autenticaci√≥n
  - Funciones: `login()`, `logout()`, `checkAuth()`
  - Maneja tokens JWT en localStorage

**Principio clave:** Los controladores coordinan la l√≥gica entre vistas y servicios.

---

#### üîå SERVICIOS (src/services/)

**Responsabilidad:** Comunicaci√≥n con el backend (API calls).

**Nota:** Actualmente las llamadas API est√°n en los componentes, pero el proyecto est√° preparado para migrarlas a esta capa.

Estructura recomendada:
```typescript
// src/services/productoService.ts
export const obtenerProductos = async () => {
  const response = await fetch(`${API_URL}/productos`);
  return response.json();
};
```

---

## üéì Ventajas de la Arquitectura MVC en este proyecto

### 1. **Separaci√≥n de responsabilidades**
Cada archivo tiene una funci√≥n espec√≠fica y clara:
- Modelos: solo datos
- Controladores: solo l√≥gica
- Rutas: solo endpoints
- Vistas: solo UI

### 2. **Facilidad de mantenimiento**
Si necesitas cambiar la base de datos de SQLite a PostgreSQL:
- Solo modificas los archivos en `models/`
- Los controladores y rutas permanecen intactos

### 3. **Escalabilidad**
Agregar una nueva funcionalidad (ejemplo: sistema de cupones):
```
1. Crear models/CuponModel.js
2. Crear controllers/CuponController.js
3. Crear routes/cupones.js
4. Montar en routes/index.js
```

### 4. **Testing independiente**
Puedes testear cada capa por separado:
- Unit tests para modelos
- Integration tests para controladores
- E2E tests para rutas

### 5. **Trabajo en equipo**
Varios desarrolladores pueden trabajar simult√°neamente:
- Desarrollador A: backend (models + controllers)
- Desarrollador B: frontend (views)
- Desarrollador C: rutas y middleware

---

## üîß Instalaci√≥n y Configuraci√≥n

### Requisitos previos

- **Node.js 18+** instalado
- **npm** o **yarn** como gestor de paquetes

### Pasos de instalaci√≥n

1. **Clonar el repositorio**

```bash
git clone https://github.com/marcostoledo96/demo_sanpaholmes.git
cd demo_sanpaholmes
```

2. **Instalar dependencias**

```bash
npm install
```

3. **Inicializar la base de datos**

```bash
node db/sqlite-init.js
```

Este comando crea la base de datos SQLite con las tablas necesarias y datos de ejemplo.

4. **Iniciar el servidor backend**

En una terminal:

```bash
node server.js
```

El servidor estar√° disponible en `http://localhost:3000`

5. **Iniciar el servidor de desarrollo frontend**

En otra terminal:

```bash
npm run dev
```

El frontend estar√° disponible en `http://localhost:5173`

6. **Acceder a la aplicaci√≥n**

- **Cliente:** http://localhost:5173/
- **Panel Admin:** http://localhost:5173/vendor/login

### Credenciales de administrador

- **Usuario:** `admin`
- **Contrase√±a:** `admin123`

---

## üíª Uso del Sistema

### Para clientes (compradores)

1. **Navegar al cat√°logo** - Ver todos los productos disponibles
2. **Agregar productos al carrito** - Seleccionar productos y cantidades
3. **Revisar el carrito** - Ver resumen de productos seleccionados
4. **Proceder al checkout** - Completar datos del comprador
5. **Confirmar pedido** - Recibir confirmaci√≥n con n√∫mero de pedido

### Para administradores

1. **Iniciar sesi√≥n** en `/vendor/login`
2. **Gestionar productos:**
   - Crear nuevos productos
   - Editar productos existentes
   - Marcar como disponible/no disponible
   - Eliminar productos definitivamente
3. **Visualizar ventas:**
   - Ver todas las compras en tiempo real
   - Filtrar por nombre, tel√©fono o mesa
   - Ver detalles de cada pedido
   - Exportar datos a Google Sheets
4. **Notificar compradores:**
   - Enviar mensajes por WhatsApp cuando el pedido est√° listo

---

## üóÑÔ∏è Base de Datos

### Esquema de la base de datos SQLite

**Tabla: `productos`**
```sql
CREATE TABLE productos (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  nombre TEXT NOT NULL,
  descripcion TEXT,
  precio REAL NOT NULL,
  categoria TEXT NOT NULL,
  imagen TEXT,
  activo INTEGER DEFAULT 1,
  creado_en TEXT DEFAULT CURRENT_TIMESTAMP
);
```

**Tabla: `usuarios`**
```sql
CREATE TABLE usuarios (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  username TEXT UNIQUE NOT NULL,
  password_hash TEXT NOT NULL,
  nombre_completo TEXT,
  email TEXT,
  role TEXT DEFAULT 'vendor',
  activo INTEGER DEFAULT 1,
  creado_en TEXT DEFAULT CURRENT_TIMESTAMP
);
```

**Tabla: `compras`**
```sql
CREATE TABLE compras (
  id INTEGER PRIMARY KEY AUTOINCREMENT,
  comprador_nombre TEXT NOT NULL,
  comprador_telefono TEXT NOT NULL,
  comprador_mesa TEXT,
  comprador_detalles TEXT,
  items TEXT NOT NULL,
  total REAL NOT NULL,
  comprobante TEXT,
  listo INTEGER DEFAULT 0,
  creado_en TEXT DEFAULT CURRENT_TIMESTAMP
);
```

---

## üîê Sistema de Autenticaci√≥n

### Flujo de autenticaci√≥n

1. El usuario ingresa credenciales en `/vendor/login`
2. El backend valida las credenciales con bcrypt
3. Si son correctas, genera un JWT con rol del usuario
4. El token se guarda en `localStorage` del navegador
5. El token se env√≠a en el header `Authorization` en cada petici√≥n protegida
6. El backend valida el token en cada endpoint protegido

### Persistencia de sesi√≥n

- La sesi√≥n se mantiene activa incluso al recargar la p√°gina
- El token JWT tiene una duraci√≥n de 24 horas
- Al cerrar sesi√≥n, se elimina el token de `localStorage`

### Opci√≥n "Recordar usuario y contrase√±a"

- Esta opci√≥n **solo** guarda las credenciales en el formulario de login
- La sesi√≥n **siempre** se guarda autom√°ticamente para mantener al usuario logueado
- Si desmarc√°s esta opci√≥n, el formulario quedar√° vac√≠o al volver al login

---

## üì± Caracter√≠sticas Especiales

### Integraci√≥n con WhatsApp

Los administradores pueden notificar a los compradores por WhatsApp cuando su pedido est√° listo. El sistema:

- Formatea autom√°ticamente el n√∫mero telef√≥nico (agrega c√≥digo de pa√≠s 54 para Argentina)
- Genera un mensaje personalizado con los detalles del pedido
- Abre WhatsApp Web con el mensaje pre-cargado

### Exportaci√≥n a Google Sheets

El sistema permite exportar todas las ventas a Google Sheets para an√°lisis posterior. Esta funcionalidad requiere configuraci√≥n adicional con Google Apps Script.

### Gesti√≥n de im√°genes

- Las im√°genes de productos se almacenan en `public/images/`
- El sistema soporta URLs externas o rutas locales
- Tiene un sistema de fallback para im√°genes no encontradas

---

## üõ†Ô∏è Scripts Disponibles

```bash
# Desarrollo
npm run dev           # Inicia el servidor de desarrollo de Vite

# Producci√≥n
npm run build         # Construye la aplicaci√≥n para producci√≥n
npm run preview       # Previsualiza la build de producci√≥n

# Backend
node server.js        # Inicia el servidor Express en puerto 3000

# Base de datos
node db/sqlite-init.js       # Inicializa la base de datos
node db/run-migration.js     # Ejecuta migraciones (si las hay)
```

---

## üöÄ Deployment

### Vercel (Recomendado)

1. Pushear el c√≥digo a GitHub
2. Importar el proyecto en Vercel
3. Vercel detectar√° autom√°ticamente la configuraci√≥n en `vercel.json`
4. Deploy autom√°tico en cada push

**Nota:** En producci√≥n, consider√° migrar a una base de datos cloud como Neon (PostgreSQL) o PlanetScale (MySQL).

### Variables de entorno

Si us√°s servicios externos, configur√° estas variables en tu servicio de hosting:

```env
NODE_ENV=production
PORT=3000
JWT_SECRET=tu-secreto-jwt-super-seguro
```

---

## üé® Personalizaci√≥n

### Colores del tema

Los colores principales se definen en `tailwind.config.js`:

```javascript
theme: {
  extend: {
    colors: {
      primary: '#fbbf24',    // Amarillo principal
      background: '#0a0a0a', // Fondo oscuro
      card: '#1a1a1a',       // Tarjetas
    }
  }
}
```

### Modificar el cat√°logo de productos

Pod√©s agregar, editar o eliminar productos desde el panel de administraci√≥n, o modificar directamente la base de datos:

```javascript
// Agregar un producto nuevo mediante el panel admin
// O ejecutar SQL directo:
db.prepare(`
  INSERT INTO productos (nombre, descripcion, precio, categoria, imagen)
  VALUES (?, ?, ?, ?, ?)
`).run('Producto Nuevo', 'Descripci√≥n', 100, 'Comida', '/images/producto.jpg');
```

---

## üß™ Testing

### Probar el sistema localmente

1. **Probar como cliente:**
   - Navegar a `http://localhost:5173/`
   - Agregar productos al carrito
   - Completar el checkout
   - Verificar la confirmaci√≥n

2. **Probar como administrador:**
   - Login en `http://localhost:5173/vendor/login`
   - Crear, editar y eliminar productos
   - Ver las ventas en tiempo real
   - Probar la exportaci√≥n a Google Sheets

---

## üêõ Soluci√≥n de Problemas

### El servidor backend no inicia

- Verific√° que el puerto 3000 est√© disponible
- Ejecut√° `npm install` para asegurar todas las dependencias
- Revis√° los logs del servidor en la consola

### Error de base de datos

- Ejecut√° `node db/sqlite-init.js` para recrear la base de datos
- Verific√° que el archivo `db/sanpaholmes.db` tenga permisos de escritura

### El frontend no se conecta al backend

- Verific√° que el backend est√© corriendo en `http://localhost:3000`
- Revis√° la configuraci√≥n de la URL de API en `src/config/api.ts`

---

## üìù Notas T√©cnicas

### Decisiones de dise√±o

1. **SQLite en lugar de PostgreSQL:**
   - Facilita la configuraci√≥n local
   - No requiere servidor de base de datos externo
   - Suficiente para el volumen de datos del proyecto

2. **JWT para autenticaci√≥n:**
   - Stateless - no requiere almacenar sesiones en el servidor
   - Escalable y compatible con arquitecturas serverless
   - Seguro si se configura correctamente

3. **React + TypeScript:**
   - Type safety reduce bugs en producci√≥n
   - Mejor experiencia de desarrollo con autocompletado
   - C√≥digo m√°s mantenible a largo plazo

4. **Tailwind CSS:**
   - Desarrollo r√°pido con clases utilitarias
   - CSS m√≠nimo en producci√≥n (tree-shaking)
   - Consistencia visual en toda la aplicaci√≥n

### Mejoras futuras

- [ ] Migraci√≥n a PostgreSQL para entornos de producci√≥n
- [ ] Sistema de roles m√°s granular (admin, vendor, moderator)
- [ ] Dashboard con gr√°ficos de ventas
- [ ] Soporte para m√∫ltiples eventos simult√°neos
- [ ] Sistema de inventario con stock
- [ ] Notificaciones push para pedidos nuevos
- [ ] Sistema de cupones de descuento
- [ ] Integraci√≥n con pasarelas de pago

---

## üë®‚Äçüíª Autor

**Marcos Toledo**

- GitHub: [@marcostoledo96](https://github.com/marcostoledo96)
- Proyecto: SanpaHolmes 2025

---

## üìÑ Licencia

Este proyecto fue desarrollado espec√≠ficamente para el evento Scout SanpaHolmes 2025.

---

## üôè Agradecimientos

- Al grupo Scout SanpaHolmes por la oportunidad de desarrollar este sistema
- A todos los asistentes del evento que usaron la plataforma
- A la comunidad de desarrolladores por las herramientas open-source utilizadas

---

## üìû Contacto

Para consultas sobre el proyecto, pod√©s:

- Abrir un issue en GitHub
- Contactar al autor por los medios indicados arriba

---

**Desarrollado con ‚ù§Ô∏è para el evento Scout SanpaHolmes 2025**
